<!doctype html><html lang=en-us>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge,chrome=1">
<title>Progress on Allen Interval Algebra | Jason Morris</title>
<meta name=viewport content="width=device-width,minimum-scale=1">
<meta name=description content="This has been a very busy week, with 3 guest lectures at Sciences Po, and a Rules as Code presentation for the OECD’s Governing After…">
<meta name=generator content="Hugo 0.91.2">
<meta name=ROBOTS content="NOINDEX, NOFOLLOW">
<link rel=stylesheet href=/ananke/css/main.min.css>
<meta property="og:title" content="Progress on Allen Interval Algebra">
<meta property="og:description" content="This has been a very busy week, with 3 guest lectures at Sciences Po, and a Rules as Code presentation for the OECD’s Governing After…">
<meta property="og:type" content="article">
<meta property="og:url" content="https://JasonMorrisSC.github.io/post/roundtablelaw/computational-law-diary-progress-on-allen-interval-algebra-e283a2ddf005/"><meta property="article:section" content="post">
<meta property="article:published_time" content="2020-11-19T17:11:28+00:00">
<meta property="article:modified_time" content="2020-11-19T17:11:28+00:00">
<meta itemprop=name content="Progress on Allen Interval Algebra">
<meta itemprop=description content="This has been a very busy week, with 3 guest lectures at Sciences Po, and a Rules as Code presentation for the OECD’s Governing After…"><meta itemprop=datePublished content="2020-11-19T17:11:28+00:00">
<meta itemprop=dateModified content="2020-11-19T17:11:28+00:00">
<meta itemprop=wordCount content="1106">
<meta itemprop=keywords content><meta name=twitter:card content="summary">
<meta name=twitter:title content="Progress on Allen Interval Algebra">
<meta name=twitter:description content="This has been a very busy week, with 3 guest lectures at Sciences Po, and a Rules as Code presentation for the OECD’s Governing After…">
</head>
<body class="ma0 avenir bg-near-white">
<header>
<div class=bg-black>
<nav class="pv3 ph3 ph4-ns" role=navigation>
<div class="flex-l justify-between items-center center">
<a href=/ class="f3 fw2 hover-white no-underline white-90 dib">
Jason Morris
</a>
<div class="flex-l items-center">
<ul class="pl0 mr3">
<li class="list f5 f4-ns fw4 dib pr3">
<a class="hover-white no-underline white-90" href=/about/ title="About Jason page">
About Jason
</a>
</li>
<li class="list f5 f4-ns fw4 dib pr3">
<a class="hover-white no-underline white-90" href=/project/ title="Projects page">
Projects
</a>
</li>
<li class="list f5 f4-ns fw4 dib pr3">
<a class="hover-white no-underline white-90" href=/post/ title="Rules as Code Diary page">
Rules as Code Diary
</a>
</li>
</ul>
<div class=ananke-socials>
<a href=https://twitter.com/RoundTableLaw target=_blank class="twitter ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Twitter link" rel=noopener aria-label="follow on Twitter——Opens in a new window">
<span class=icon><svg style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:{{ .fill }}"/></svg>
</span>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a>
</div>
</div>
</div>
</nav>
</div>
</header>
<main class=pb7 role=main>
<article class="flex-l flex-wrap justify-between mw8 center ph3">
<header class="mt4 w-100">
<aside class="instapaper_ignoref b helvetica tracked">
RULES AS CODE DIARY
</aside>
<div id=sharing class="mt3 ananke-socials">
<a href="https://twitter.com/share?url=https://JasonMorrisSC.github.io/post/roundtablelaw/computational-law-diary-progress-on-allen-interval-algebra-e283a2ddf005/&text=Progress%20on%20Allen%20Interval%20Algebra" class="ananke-social-link twitter no-underline" aria-label="share on Twitter">
<span class=icon><svg style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:{{ .fill }}"/></svg>
</span>
</a>
</div>
<h1 class="f1 athelas mt3 mb1">Progress on Allen Interval Algebra</h1>
<time class="f6 mv4 dib tracked" datetime=2020-11-19T17:11:28Z>November 19, 2020</time>
</header>
<div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l"><p>This has been a very busy week, with 3 guest lectures at Sciences Po, and a Rules as Code presentation for the OECD’s Governing After Shock web conference, plus a prep meeting for the Canada School of Public Service <a href=https://www.csps-efpc.gc.ca/events/digital-forum-intelligence/index-eng.aspx>Open Government conference next week</a>, which I understand is expecting more than 3000 attendees. If you’d like to register, follow the link.</p>
<p>But I have a little progress to report on the Allen Interval Algebra library I was <a href=https://roundtablelaw.medium.com/computational-law-diary-getting-smarter-about-time-7a72f5275ca7>telling you about last week</a>.</p>
<h4 id=shining-some-light-on-john>Shining Some Light on John</h4>
<p>One example problem in temporal logic is the sentence “John was not in the room when I touched the switch to turn on the light.”</p>
<p>Using Allen algebra we need to break this sentence down into its intervals, and then set out what we know about the relationships between those intervals.</p>
<p>There are three intervals: the period of time during which John was in the room, the period of time during which I was touching the switch, and the period of time during which the light was on.</p>
<p>Using the code I’m working on, you can declare them as Allen Intervals like this.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-prolog data-lang=prolog><span style=color:#e6db74>john_in_room:</span>Allen_Interval.  
<span style=color:#e6db74>i_touch_switch:</span>Allen_Interval.  
<span style=color:#e6db74>light_on:</span>Allen_Interval.
</code></pre></div><h4 id=making-the-links>Making the Links</h4>
<p>You need to then describe what you know about the relationship between two of these intervals at a time, in terms of the 13 basic relations available in the Allen algebra.</p>
<p>For the relationship between John being in the room and my touching the switch, we know those two things did not happen at the same time. So the only remaining possible relationships are preceding, meeting, preceded_by, or met_by. So you can set that out explicitly like this:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-prolog data-lang=prolog><span style=color:#e6db74>john_to_switch:</span>Allen_Link[  
    <span style=color:#e6db74>from-&gt;john_in_room</span>,  
    <span style=color:#e6db74>to-&gt;i_touch_switch</span>,  
    <span style=color:#e6db74>relationship-&gt;john_to_switch_rel:</span>Allen_Relationship[  
        <span style=color:#e6db74>precedes</span>,  
        <span style=color:#e6db74>meets</span>,  
        <span style=color:#e6db74>met_by</span>,  
        <span style=color:#e6db74>preceded_by</span>  
    ]  
].
</code></pre></div><p>With regard to the relationship between the light being on and touching the switch, we know it was off before I touched the switch, and turned on before or when I stopped touching the switch. And we know it stayed on after I stopped touching the switch. So the only valid relations are that touching the switch “meets” or “overlaps” with the light being on.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-prolog data-lang=prolog><span style=color:#e6db74>switch_to_light:</span>Allen_Link[  
    <span style=color:#e6db74>from-&gt;i_touch_switch</span>,  
    <span style=color:#e6db74>to-&gt;light_on</span>,  
    <span style=color:#e6db74>relationship-&gt;switch_to_light_rel:</span>Allen_Relationship[  
        <span style=color:#e6db74>meets</span>,  
        <span style=color:#e6db74>overlaps</span>  
    ]  
].
</code></pre></div><h4 id=asking-questions>Asking Questions</h4>
<p>The point is to be able to infer things about the relationship in time between the intervals that we don’t have directly linking information for. So we want to ask questions about the relationship between John being in the room, and the light being on.</p>
<p>For example, we might ask “is it possible that John was in the room while the light was on?” In Allen algebra, the translation is to ask whether the relationship between the two intervals includes the possibility of one of the 9 different basic relations that involve some degree of overlap.</p>
<p>That question can be written like this:</p>
<pre tabindex=0><code>john_in_room[strongest_implied_relation(light_on)-&gt;?_rel],  
?_rel[  
 overlaps;  
 overlapped_by;  
 finishes;  
 finished_by;  
 contains;  
 during;  
 starts;  
 started_by;  
 equal_to  
].
</code></pre><p>If you run that query, the answer is “yes.” It’s possible that john was in the room while the light was on, because he might have entered the room after it was turned on.</p>
<p>We can also ask questions like “is it possible that John was in the room before the light was on, and still in the room after it was off again?”</p>
<p>That question is easier to pose:</p>
<pre tabindex=0><code>john_in_room[strongest_implied_relation(light_on)-&gt;?_rel],  
?_rel[contains].
</code></pre><p>And the answer you get back is “no”, because he was not in the room when the light was turned on, so he cannot have been in the room for the entire time the light was on.</p>
<h4 id=a-timely-example-of-formal-verification>A Timely Example of Formal Verification</h4>
<p>One of the things that we are working on at the SMU Centre for Computational Law is creating a language that supports “formal verification” techniques. These are techniques to analyze and learn something useful about a set of encoded rules.</p>
<p>It turns out that Allen Interval Algebra provides an easy-to-understand example of how formal verification can work.</p>
<p>Let’s imagine that in order to fly during Covid, you need a negative covid test that was taken within 3 days of departure. And let’s imagine that in order to fly you need permission to land from your point of arrival, which requires a negative test result. And let’s imagine it takes two days to get a result of a Covid test, and it takes two days to get the permission.</p>
<p>You can clearly see that this is impossible. Two days for the test plus two days for the permission is 4 days, which is more than the maximum of three. So it doesn’t matter what you do, the rules are impossible to adhere to.</p>
<p>That’s obvious to us because the number of rules is small. But what if the overlapping rules were more complicated and the impossibility harder to see, or only happened some of the time? Could the computer notice a problem like that for you?</p>
<p>It turns out that with Allen Interval Algebra, it can. The trick is to try and derive Allen relationships between all combinations of the intervals, and combine that information with what you already know. If in the combined result there are any two intervals that have no relationship at all, then you know you have a set of rules that create an impossible-to-meet deadline.</p>
<p>I’m looking forward to being able to demonstrate that capability soon.</p>
<h4 id=next-steps>Next Steps</h4>
<p>I anticipate that when I model “events” in code, each event will also becomes an Allen interval. And if we know exactly when the events occurred-that is, we have dates and durations for them-then we can derive the Allen relationships on the basis of that information, too.</p>
<p>But what using Allen interval algebra allows you to do that you can’t do with just dates and times is to give relative time information. Instead of saying “I got the ticket on January 7”, you can say “I got the ticket at some time prior to when my license expired.” Which may be all the temporal information you need in order to answer your question.</p>
<p>So the next steps are to integrate the algebra with a broader event system. Which means I need a broader event system. I’m currently reading up on Event Calculus. I will probably implement an event calculus system by itself, first, and then think about how difficult it would be to allow you to use Allen relationship data instead of dates and times in those events.</p>
<h3 id=quick-notes>Quick Notes</h3>
<ul>
<li>Nov 24: “Rules as Code” session with Canada School of Public Service as part of their <a href=https://www.csps-efpc.gc.ca/events/digital-forum-intelligence/index-eng.aspx>Open Government conference</a>.</li>
<li>Jan 12–14: Presenting on Blawx at the Legal Services Corporation Innovations in Technology (Virtual) Conference.</li>
<li>TBD (Jan ’21): Cyberjustice Laboratory (University of Montreal) webinar on <a href=https://www.blawx.com/>Blawx</a>.</li>
</ul>
<ul class=pa0>
</ul>
<div class="mt6 instapaper_ignoref">
</div>
</div>
<aside class="w-30-l mt6-l"><div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links">
<p class="f5 b mb3">What's in this post</p>
<nav id=TableOfContents>
<ul>
<li>
<ul>
<li>
<ul>
<li>
<ul>
<li><a href=#shining-some-light-on-john>Shining Some Light on John</a></li>
<li><a href=#making-the-links>Making the Links</a></li>
<li><a href=#asking-questions>Asking Questions</a></li>
<li><a href=#a-timely-example-of-formal-verification>A Timely Example of Formal Verification</a></li>
<li><a href=#next-steps>Next Steps</a></li>
</ul>
</li>
<li><a href=#quick-notes>Quick Notes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</div>
<div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links">
<p class="f5 b mb3">Related</p>
<ul class="pa0 list">
<li class=mb2>
<a href=/post/roundtablelaw/computational-law-diary-getting-smarter-about-time-7a72f5275ca7/>Getting Smarter about Time</a>
</li>
<li class=mb2>
<a href=/post/roundtablelaw/computational-law-diary-more-explanations-encoding-safe-again-and-twitch-9f60d20d0a99/>More Explanations, Encoding SAFE again, and Twitch</a>
</li>
<li class=mb2>
<a href=/post/roundtablelaw/computational-law-diary-progress-on-explanations-2ad8e37e30ad/>Progress on Explanations</a>
</li>
<li class=mb2>
<a href=/post/roundtablelaw/computational-law-diary-adding-explanations-to-blawx-bdbd3e27e366/>Adding Explanations to Blawx</a>
</li>
<li class=mb2>
<a href=/post/roundtablelaw/computational-law-diary-encoding-for-greater-clarity-provisions-698a83f4612c/>Encoding “For Greater Clarity” Provisions</a>
</li>
<li class=mb2>
<a href=/post/roundtablelaw/playing-along-with-rules-as-code-6c837b42a33e/>Playing Along with Rules as Code</a>
</li>
<li class=mb2>
<a href=/post/roundtablelaw/live-demo-integrating-docassemble-and-ergo-lite-for-logic-coding-f35e9f25f311/>Live Demo: Integrating Docassemble and Ergo Lite for Logic Coding</a>
</li>
<li class=mb2>
<a href=/post/roundtablelaw/a-computer-takes-the-lsat-conclusion-86dc7467b14d/>A Computer Takes the LSAT: Conclusion</a>
</li>
<li class=mb2>
<a href=/post/roundtablelaw/a-computer-takes-the-lsat-resources-77e5d07d7e3a/>A Computer Takes the LSAT: Resources</a>
</li>
<li class=mb2>
<a href=/post/roundtablelaw/a-computer-takes-the-lsat-generating-fact-scenarios-3a52fd6fe908/>A Computer Takes the LSAT: Generating Fact Scenarios</a>
</li>
<li class=mb2>
<a href=/post/roundtablelaw/a-computer-takes-the-lsat-question-6-884c47d55b2b/>A Computer Takes the LSAT: Question 6</a>
</li>
<li class=mb2>
<a href=/post/roundtablelaw/a-computer-takes-the-lsat-question-7-aa98d14d3217/>A Computer Takes the LSAT: Question 7</a>
</li>
<li class=mb2>
<a href=/post/roundtablelaw/a-computer-takes-the-lsat-question-8-bf39194443da/>A Computer Takes the LSAT: Question 8</a>
</li>
<li class=mb2>
<a href=/post/roundtablelaw/a-computer-takes-the-lsat-question-9-f33d7200f48f/>A Computer Takes the LSAT: Question 9</a>
</li>
<li class=mb2>
<a href=/post/roundtablelaw/a-computer-takes-the-lsat-question-10-2172137fdc57/>A Computer Takes the LSAT: Question 10</a>
</li>
</ul>
</div>
</aside>
</article>
</main>
<footer class="bg-black bottom-0 w-100 pa3" role=contentinfo>
<div class="flex justify-between">
<a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://JasonMorrisSC.github.io>
&copy; Jason Morris 2022
</a>
<div>
<div class=ananke-socials>
<a href=https://twitter.com/RoundTableLaw target=_blank class="twitter ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Twitter link" rel=noopener aria-label="follow on Twitter——Opens in a new window">
<span class=icon><svg style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:{{ .fill }}"/></svg>
</span>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a>
</div></div>
</div>
</footer>
</body>
</html>